<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Objects</title>

    <script>

        // dit is het kaartobject
        function card(t,n,c) {
            this.type = t;
            this.number = n;
            this.color = c;
            this.opened = false; // is de kaart zichtbaar, standaard niet?

            // een method toevoegen voor turn (draaien van de kaart)
            // als input is het HTML element nodig welke de animatie moet bevatten (= e)
            this.turn = async function(e) {
                await this.random(e); // pick een random kaart (en wacht tot functie klaar is)

                // indien het element nog niet is gekoppeld aan de class: flip, voeg hem dan toe
                // dit heeft starten van de animatie als gevolg
                if(!e.classList.contains('flip')) {
                    e.classList.add('flip')
                    this.opened=true;
                    return true;
                } else {
                    // indien dit niet het geval is, verwijder de class: flip
                    // ook nu wordt de animatie afgespeeld, maar weer terug naar de initiele staat
                    e.classList.remove('flip')
                    this.opened=false;
                    return false;
                }
            }

            // een methode om een random kaart te kiezen
            this.random = async function(e) {

                if(!this.opened) {
                    let decks = [
                        ["#000000",["♠"],[2,3,4,5,6,7,8,9,10,"B","V","H","A"]],
                        ["#000000",["♣"],[2,3,4,5,6,7,8,9,10,"B","V","H","A"]],
                        ["#FF0000",["♦"],[2,3,4,5,6,7,8,9,10,"B","V","H","A"]],
                        ["#FF0000",["♥"],[2,3,4,5,6,7,8,9,10,"B","V","H","A"]],
                    ];

                    // kies random item uit een array -> deck ♠, ♣, ♦ of ♥
                    let randomDeck = decks[Math.floor(Math.random()*decks.length)];
                    // uit gekozen random deck, kies een random kaart....
                    let randomNr = randomDeck[2][Math.floor(Math.random()*randomDeck[2].length)];

                    this.number = randomNr;
                    this.type=randomDeck[1];
                    this.color = randomDeck[0];

                    // koppel nummer en type aan de HTML elementen
                    numbers = document.querySelectorAll(".number > div:nth-child(1)");
                    types = document.querySelectorAll(".number > div:nth-child(2)");

                    numbers.forEach(function(e) {
                        e.innerText = randomNr;
                        e.style.color = randomDeck[0];
                    });

                    types.forEach(function (e) {
                        e.innerText = randomDeck[1];
                        e.style.color = randomDeck[0];
                    });
               }
                return; // finished
            }

        }

        let mycard = null;
        let numbers = null;
        let types = null;

        document.addEventListener("DOMContentLoaded",function() {

            // eerst de kaart uit het HTML DOM ophalen
            let ele_playcard = document.getElementById("playcard")

            // een nieuw kaart object maken
            mycard = new card("♠",9,"#FF0000"); // met de input doen we even niets, random items worden gekozen

            // zodra geklikt wordt op het kaart element worden de nummers gezet
            // en zal deze worden omgedraaid
            ele_playcard.addEventListener("click",function() {
                // kaart omdraaien, promise object komt terug (omdat er met een async functie wordt gewerkt)
                mycard.turn(ele_playcard).then(function (result) {
                    if(result) {
                        console.log(`${mycard.type} - ${mycard.number}`);
                    }
                });
            });




        });

    </script>

    <style>
        html {
            font-family: Arial;
        }

        main {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
        }

        #playcard {
            position: relative;
            transition: transform 0.6s;
            transform-style: preserve-3d;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        /*
        We werken niet meer met de hover pseudoclass maar gaan voor het klikken op de kaart
        */

        /*
        #playcard:hover {
           transform: rotateY(180deg);
        }
        */

        /*
        Wanneer deze class wordt gekoppeld aan de kaart zal animatie plaats vinden.
        bij verwijderen speelt animatie weer terug
         */
        .flip {
            transform: rotateY(180deg);
        }

        .front, .back {
            position: absolute;
            display: flex;
            padding: 5px;
            border-radius: 15px;
            width: 178px;
            height: 250px;
            backface-visibility: hidden;
        }

        .front {
            border: 1px solid black;
            transform: rotateY(180deg);
        }

        .back {
            background-image: url("images/cardback.png");
            background-size: cover;
        }

        .col {
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content:space-between;
        }

        .col:nth-child(1), .col:nth-child(3) {
            width: 20%;
        }

        .col:nth-child(2) {
            width:60%;
        }

        .number {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .number > div:nth-child(1) {
            font-weight: bold;
        }

        .number > div:nth-child(2) {
            font-weight: bold;
            font-size: 2em;
        }

    </style>

</head>
<body>

<main>

<div id="playcard">
    <div class="front">
        <div class="col">
            <div class="number">
                <div>x</div>
                <div>x</div>
            </div>
            <div class="number">
                <div>x</div>
                <div>x</div>
            </div>
        </div>
        <div class="col">

        </div>
        <div class="col">
            <div class="number">
                <div>x</div>
                <div>x</div>
            </div>
            <div class="number">
                <div>x</div>
                <div>x</div>
            </div>
        </div>
    </div>
    <div class="back">

    </div>
</div>

</main>

</body>
</html>